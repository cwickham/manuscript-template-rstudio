<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving
and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd">

<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">

<front>
<journal-meta>
<journal-id></journal-id>

<journal-title-group>
<journal-title>Earth and Space Science</journal-title>
</journal-title-group>
<issn></issn>

<publisher>
<publisher-name></publisher-name>
</publisher>
</journal-meta>


<article-meta>


<title-group>
<article-title>La Palma Earthquakes</article-title>
</title-group>

<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
<name>
<surname>Purves</surname>
<given-names>Steve</given-names>
</name>
<string-name>Steve Purves</string-name>
<email>steve@curvenote.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1">a</xref>
<xref ref-type="corresp" rid="cor-1">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-7859-8394</contrib-id>
<name>
<surname>Cockett</surname>
<given-names>Rowan</given-names>
</name>
<string-name>Rowan Cockett</string-name>
<xref ref-type="aff" rid="aff-1">a</xref>
</contrib>
</contrib-group>
<aff id="aff-1">
<institution-wrap>
<institution>Curvenote</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1">steve@curvenote.com</corresp>
</author-notes>

<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2023-06-23">
<year>2023</year>
<month>6</month>
<day>23</day>
</pub-date>







<history></history>


<abstract>
<p>In September 2021, a significant jump in seismic activity on the
island of La Palma (Canary Islands, Spain) signaled the start of a
volcanic crisis that still continues at the time of writing. Earthquake
data is continually collected and published by the Instituto Geográphico
Nacional (IGN). …</p>
</abstract>
<kwd-group kwd-group-type="author">
<kwd>La Palma</kwd>
<kwd>Earthquakes</kwd>
</kwd-group>




</article-meta>

</front>

<body>
<sec id="introduction">
  <title>1 Introduction</title>
  <fig id="fig-timeline">
    <caption><p>Figure 1: Timeline of recent earthquakes on La
    Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-timeline-1.png" />
  </fig>
  <p>Based on data up to and including 1971, eruptions on La Palma
  happen every 79.8 years on average.</p>
  <p>Studies of the magma systems feeding the volcano, such as Marrero
  et al.
  (<xref alt="2019" rid="ref-marrero2019" ref-type="bibr">2019</xref>),
  have proposed that there are two main magma reservoirs feeding the
  Cumbre Vieja volcano; one in the mantle (30-40km depth) which charges
  and in turn feeds a shallower crustal reservoir (10-20km depth).</p>
  <p>Eight eruptions have been recorded since the late 1400s
  (<xref alt="Figure 1" rid="fig-timeline">Figure 1</xref>).</p>
  <p>Data and methods are discussed in
  <xref alt="Section 2" rid="sec-data-methods">Section 2</xref>.</p>
  <p>Let <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  denote the number of eruptions in a year. Then
  <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  can be modeled by a Poisson distribution:</p>
  <p><styled-content id="eq-poisson"><disp-formula><alternatives>
  <tex-math><![CDATA[
  p(x)=\frac{e^{-\lambda} \lambda^{x}}{x !}
   \qquad(1)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>!</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
  <p>Where <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  is the rate of eruptions per year. Using
  <xref alt="Equation 1" rid="eq-poisson">Equation 1</xref>, the
  probability of an eruption in the next <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
  years can be calculated.</p>
  <table-wrap>
    <caption>
      <p>Table 1: Recent historic eruptions on La Palma</p>
    </caption>
    <table id="tbl-history">
      <thead>
        <tr>
          <th>Name</th>
          <th>Year</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Current</td>
          <td>2021</td>
        </tr>
        <tr>
          <td>Teneguía</td>
          <td>1971</td>
        </tr>
        <tr>
          <td>Nambroque</td>
          <td>1949</td>
        </tr>
        <tr>
          <td>El Charco</td>
          <td>1712</td>
        </tr>
        <tr>
          <td>Volcán San Antonio</td>
          <td>1677</td>
        </tr>
        <tr>
          <td>Volcán San Martin</td>
          <td>1646</td>
        </tr>
        <tr>
          <td>Tajuya near El Paso</td>
          <td>1585</td>
        </tr>
        <tr>
          <td>Montaña Quemada</td>
          <td>1492</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p><xref alt="Table 1" rid="tbl-history">Table 1</xref> summarises the
  eruptions recorded since the colonization of the islands by Europeans
  in the late 1400s.</p>
  <fig id="fig-map">
    <caption><p>Figure 2: Map of La Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/la-palma-map.png" />
  </fig>
  <p>La Palma is one of the west most islands in the Volcanic
  Archipelago of the Canary Islands
  (<xref alt="Figure 2" rid="fig-map">Figure 2</xref>).</p>
  <fig id="fig-spatial-plot">
    <caption><p>Figure 3: Locations of earthquakes on La Palma since
    2017.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-spatial-plot-output-1.png" />
  </fig>
  <p><xref alt="Figure 3" rid="fig-spatial-plot">Figure 3</xref> shows
  the location of recent Earthquakes on La Palma.</p>
</sec>
<sec id="sec-data-methods">
  <title>2 Data &amp; Methods</title>
</sec>
<sec id="conclusion">
  <title>3 Conclusion</title>
</sec>
<sec id="references">
  <title>References</title>
</sec>
</body>

<back>
<ref-list>
  <ref id="ref-marrero2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Marrero</surname><given-names>José</given-names></name>
        <name><surname>García</surname><given-names>Alicia</given-names></name>
        <name><surname>Berrocoso</surname><given-names>Manuel</given-names></name>
        <name><surname>Llinares</surname><given-names>Ángeles</given-names></name>
        <name><surname>Rodríguez-Losada</surname><given-names>Antonio</given-names></name>
        <name><surname>Ortiz</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>Strategies for the development of volcanic hazard maps in monogenetic volcanic fields: The example of La Palma (Canary Islands)</article-title>
      <source>Journal of Applied Volcanology</source>
      <year iso-8601-date="2019-07">2019</year><month>07</month>
      <volume>8</volume>
      <pub-id pub-id-type="doi">10.1186/s13617-019-0085-5</pub-id>
      <fpage></fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>

<sub-article article-type="notebook">
<front-stub>
<title-group>
<article-title>La Palma Earthquakes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
<name>
<surname>Purves</surname>
<given-names>Steve</given-names>
</name>
<string-name>Steve Purves</string-name>
<email>steve@curvenote.com</email>
<role vocab="https://credit.niso.org" vocab-term="investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation/">Investigation</role>
<role vocab="https://credit.niso.org" vocab-term="project
administration" vocab-term-identifier="https://credit.niso.org/contributor-roles/project-administration/">Project
administration</role>
<role vocab="https://credit.niso.org" vocab-term="software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software/">Software</role>
<role vocab="https://credit.niso.org" vocab-term="visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
<xref ref-type="corresp" rid="cor-1-nb-article">&#x002A;</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-7859-8394</contrib-id>
<name>
<surname>Cockett</surname>
<given-names>Rowan</given-names>
</name>
<string-name>Rowan Cockett</string-name>
<xref ref-type="aff" rid="aff-1-nb-article">a</xref>
</contrib>
</contrib-group>
<aff id="aff-1-nb-article">
<institution-wrap>
<institution>Curvenote</institution>
</institution-wrap>







</aff>
<author-notes>
<corresp id="cor-1-nb-article">steve@curvenote.com</corresp>
</author-notes>
<abstract>
<p>In September 2021, a significant jump in seismic activity on the
island of La Palma (Canary Islands, Spain) signaled the start of a
volcanic crisis that still continues at the time of writing. Earthquake
data is continually collected and published by the Instituto Geográphico
Nacional (IGN). …</p>
</abstract>
</front-stub>

<body>
<sec id="introduction-nb-article">
  <title>1 Introduction</title>
  <sec id="-nb-article" specific-use="notebook-code">
  <code language="r script">eruptions &lt;- c(1492, 1585, 1646, 1677, 1712, 1949, 1971, 2021)
n_eruptions &lt;- length(eruptions)</code>
  </sec>
  <sec id="-nb-article" specific-use="notebook-code">
  <code language="r script">par(mar = c(3, 1, 1, 1) + 0.1)
plot(eruptions, rep(0, n_eruptions), 
  pch = &quot;|&quot;, axes = FALSE, xlab = &quot;&quot;, ylab = &quot;&quot;)
axis(1)
box()</code>
  <fig id="fig-timeline-nb-article">
    <caption><p>Figure 1: Timeline of recent earthquakes on La
    Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-timeline-1.png" />
  </fig>
  </sec>
  <sec id="-nb-article" specific-use="notebook-code">
  <code language="r script">avg_years_between_eruptions &lt;- mean(diff(eruptions[-n_eruptions]))
avg_years_between_eruptions</code>
  <sec id="-output-0-nb-article" specific-use="notebook-output">
  <preformat>[1] 79.83333</preformat>
  </sec>
  </sec>
  <p>Based on data up to and including 1971, eruptions on La Palma
  happen every 79.8 years on average.</p>
  <p>Studies of the magma systems feeding the volcano, such as Marrero
  et al.
  (<xref alt="2019" rid="ref-marrero2019-nb-article" ref-type="bibr">2019</xref>),
  have proposed that there are two main magma reservoirs feeding the
  Cumbre Vieja volcano; one in the mantle (30-40km depth) which charges
  and in turn feeds a shallower crustal reservoir (10-20km depth).</p>
  <p>Eight eruptions have been recorded since the late 1400s
  (<xref alt="Figure 1" rid="fig-timeline-nb-article">Figure 1</xref>).</p>
  <p>Data and methods are discussed in
  <xref alt="Section 2" rid="sec-data-methods-nb-article">Section 2</xref>.</p>
  <p>Let <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  denote the number of eruptions in a year. Then
  <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  can be modeled by a Poisson distribution:</p>
  <p><styled-content id="eq-poisson-nb-article"><disp-formula><alternatives>
  <tex-math><![CDATA[
  p(x)=\frac{e^{-\lambda} \lambda^{x}}{x !}
   \qquad(1)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>λ</mml:mi><mml:mi>x</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:mi>x</mml:mi><mml:mi>!</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="2.0em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></styled-content></p>
  <p>Where <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  is the rate of eruptions per year. Using
  <xref alt="Equation 1" rid="eq-poisson-nb-article">Equation 1</xref>, the
  probability of an eruption in the next <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
  years can be calculated.</p>
  <table-wrap>
    <caption>
      <p>Table 1: Recent historic eruptions on La Palma</p>
    </caption>
    <table id="tbl-history-nb-article">
      <thead>
        <tr>
          <th>Name</th>
          <th>Year</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Current</td>
          <td>2021</td>
        </tr>
        <tr>
          <td>Teneguía</td>
          <td>1971</td>
        </tr>
        <tr>
          <td>Nambroque</td>
          <td>1949</td>
        </tr>
        <tr>
          <td>El Charco</td>
          <td>1712</td>
        </tr>
        <tr>
          <td>Volcán San Antonio</td>
          <td>1677</td>
        </tr>
        <tr>
          <td>Volcán San Martin</td>
          <td>1646</td>
        </tr>
        <tr>
          <td>Tajuya near El Paso</td>
          <td>1585</td>
        </tr>
        <tr>
          <td>Montaña Quemada</td>
          <td>1492</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p><xref alt="Table 1" rid="tbl-history-nb-article">Table 1</xref> summarises the
  eruptions recorded since the colonization of the islands by Europeans
  in the late 1400s.</p>
  <fig id="fig-map-nb-article">
    <caption><p>Figure 2: Map of La Palma</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="images/la-palma-map.png" />
  </fig>
  <p>La Palma is one of the west most islands in the Volcanic
  Archipelago of the Canary Islands
  (<xref alt="Figure 2" rid="fig-map-nb-article">Figure 2</xref>).</p>
  <sec id="cell-fig-spatial-plot-nb-article" specific-use="notebook-code">
  <code language="python">from matplotlib import colormaps
cmap = colormaps['viridis_r']
ax = df.plot.scatter(x=&quot;Longitude&quot;, y=&quot;Latitude&quot;, 
                     s=40-df[&quot;Depth(km)&quot;], c=df[&quot;Magnitude&quot;], 
                     figsize=(12,10), grid=&quot;on&quot;, cmap=cmap)
colorbar = ax.collections[0].colorbar
colorbar.set_label(&quot;Magnitude&quot;)

plt.show()</code>
  <sec id="cell-fig-spatial-plot-output-0-nb-article" specific-use="notebook-output">
  <fig id="fig-spatial-plot-nb-article">
    <caption><p>Figure 3: Locations of earthquakes on La Palma since
    2017.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="index_files/figure-jats/fig-spatial-plot-output-1.png" />
  </fig>
  </sec>
  </sec>
  <p><xref alt="Figure 3" rid="fig-spatial-plot-nb-article">Figure 3</xref> shows
  the location of recent Earthquakes on La Palma.</p>
</sec>
<sec id="sec-data-methods-nb-article">
  <title>2 Data &amp; Methods</title>
</sec>
<sec id="conclusion-nb-article">
  <title>3 Conclusion</title>
</sec>
<sec id="references-nb-article">
  <title>References</title>
</sec>
</body>



<back>
<ref-list>
  <ref id="ref-marrero2019-nb-article">
    <mixed-citation>Marrero, José, Alicia García, Manuel Berrocoso,
    Ángeles Llinares, Antonio Rodríguez-Losada, and R. Ortiz. 2019.
    “Strategies for the Development of Volcanic Hazard Maps in
    Monogenetic Volcanic Fields: The Example of La Palma (Canary
    Islands).” <italic>Journal of Applied Volcanology</italic> 8 (July).
    <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13617-019-0085-5">https://doi.org/10.1186/s13617-019-0085-5</ext-link>.</mixed-citation>
  </ref>
</ref-list>
</back>


</sub-article>
<sub-article article-type="notebook">
<front-stub>
<title-group>
<article-title>Data Screening</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-0760-5497</contrib-id>
<name>
<surname>Purves</surname>
<given-names>Steve</given-names>
</name>
<string-name>Steve Purves</string-name>
</contrib>
</contrib-group>
</front-stub>

<body>
<sec id="cell-96cd123b-e010-4778-9afa-9ca125ef50cc-nb-1" specific-use="notebook-content">
<p>Load and review the data, check that dates are loaded properly and
filter data down to the events in La Palma only. The dataset itself
contains all recent IGN earthquake data for Spanish territory.</p>
</sec>
<sec id="cell-0e75ded9-f2dc-40ca-884b-d124d0e37ee4-nb-1" specific-use="notebook-code">
<code language="python">import pandas as pd
import matplotlib.pyplot as plt</code>
</sec>
<sec id="ba38c3c1-51d7-48d9-8056-c23a0bbfcd18-nb-1" specific-use="notebook-code">
<code language="python">df = pd.read_csv('../data/catalogoComunSV_1663233588717.csv', sep=';')
df.columns = ['Event', 'Date', 'Time', 'Latitude', 'Longitude', 'Depth(km)', 'Intensity','Magnitude', 'Type Mag', 'Location']
df['Time'] = df['Time'].str.strip()
df['Date'] = df['Date'].str.strip()
df['DateTime'] = (df['Date'] + ' ' + df['Time']).apply(pd.to_datetime, format='%d/%m/%Y %H:%M:%S')
df['Timestamp'] = pd.to_numeric(pd.to_datetime(df['DateTime']))
df['Date'] = pd.to_datetime(df['Date'], format=&quot;%d/%m/%Y&quot;)
df = df.sort_values(by=['DateTime'], ascending=True)
df.head()</code>
<sec id="ba38c3c1-51d7-48d9-8056-c23a0bbfcd18-output-0-nb-1" specific-use="notebook-output">
<table-wrap>
  <table border="1">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>Event</th>
        <th>Date</th>
        <th>Time</th>
        <th>Latitude</th>
        <th>Longitude</th>
        <th>Depth(km)</th>
        <th>Intensity</th>
        <th>Magnitude</th>
        <th>Type Mag</th>
        <th>Location</th>
        <th>DateTime</th>
        <th>Timestamp</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>0</td>
        <td>es2017aaaga</td>
        <td>2017-01-01</td>
        <td>00:48:55</td>
        <td>36.6765</td>
        <td>-11.2736</td>
        <td>0.0</td>
        <td></td>
        <td>2.8</td>
        <td>6</td>
        <td>SW CABO DE SAN VICENTE</td>
        <td>2017-01-01 00:48:55</td>
        <td>1483231735000000000</td>
      </tr>
      <tr>
        <td>1</td>
        <td>es2017aaakn</td>
        <td>2017-01-01</td>
        <td>01:28:17</td>
        <td>28.1119</td>
        <td>-16.2225</td>
        <td>21.0</td>
        <td></td>
        <td>0.9</td>
        <td>4</td>
        <td>ATLÁNTICO-CANARIAS</td>
        <td>2017-01-01 01:28:17</td>
        <td>1483234097000000000</td>
      </tr>
      <tr>
        <td>2</td>
        <td>es2017aaang</td>
        <td>2017-01-01</td>
        <td>01:49:08</td>
        <td>42.0648</td>
        <td>-7.8471</td>
        <td>22.0</td>
        <td></td>
        <td>2.0</td>
        <td>4</td>
        <td>SW RAIRIZ DE VEIGA.OU</td>
        <td>2017-01-01 01:49:08</td>
        <td>1483235348000000000</td>
      </tr>
      <tr>
        <td>3</td>
        <td>es2017aabdd</td>
        <td>2017-01-01</td>
        <td>02:36:20</td>
        <td>38.3826</td>
        <td>-9.3767</td>
        <td>11.0</td>
        <td></td>
        <td>2.2</td>
        <td>4</td>
        <td>ATLÁNTICO-PORTUGAL</td>
        <td>2017-01-01 02:36:20</td>
        <td>1483238180000000000</td>
      </tr>
      <tr>
        <td>4</td>
        <td>es2017aabkh</td>
        <td>2017-01-01</td>
        <td>03:35:03</td>
        <td>36.2492</td>
        <td>-7.8227</td>
        <td>13.0</td>
        <td></td>
        <td>1.9</td>
        <td>4</td>
        <td>GOLFO DE CÁDIZ</td>
        <td>2017-01-01 03:35:03</td>
        <td>1483241703000000000</td>
      </tr>
    </tbody>
  </table>
</table-wrap>
</sec>
</sec>
<sec id="d81abbcf-d7f2-43e8-ae0c-5f6ce44e6046-nb-1" specific-use="notebook-code">
<code language="python">df.describe()</code>
<sec id="d81abbcf-d7f2-43e8-ae0c-5f6ce44e6046-output-0-nb-1" specific-use="notebook-output">
<table-wrap>
  <table border="1">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>Latitude</th>
        <th>Longitude</th>
        <th>Depth(km)</th>
        <th>Magnitude</th>
        <th>Type Mag</th>
        <th>Timestamp</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>count</td>
        <td>58036.000000</td>
        <td>58036.000000</td>
        <td>58036.000000</td>
        <td>58036.000000</td>
        <td>58036.000000</td>
        <td>5.803600e+04</td>
      </tr>
      <tr>
        <td>mean</td>
        <td>34.806854</td>
        <td>-8.356855</td>
        <td>11.450831</td>
        <td>1.881846</td>
        <td>4.031153</td>
        <td>1.596182e+18</td>
      </tr>
      <tr>
        <td>std</td>
        <td>5.263327</td>
        <td>7.119341</td>
        <td>11.111965</td>
        <td>0.763577</td>
        <td>0.291332</td>
        <td>4.954865e+16</td>
      </tr>
      <tr>
        <td>min</td>
        <td>26.349300</td>
        <td>-19.930400</td>
        <td>0.000000</td>
        <td>-0.500000</td>
        <td>3.000000</td>
        <td>1.483232e+18</td>
      </tr>
      <tr>
        <td>25%</td>
        <td>28.563800</td>
        <td>-16.672325</td>
        <td>3.000000</td>
        <td>1.400000</td>
        <td>4.000000</td>
        <td>1.559327e+18</td>
      </tr>
      <tr>
        <td>50%</td>
        <td>35.989200</td>
        <td>-4.785250</td>
        <td>10.000000</td>
        <td>1.800000</td>
        <td>4.000000</td>
        <td>1.612319e+18</td>
      </tr>
      <tr>
        <td>75%</td>
        <td>37.890700</td>
        <td>-3.234500</td>
        <td>14.300000</td>
        <td>2.400000</td>
        <td>4.000000</td>
        <td>1.635568e+18</td>
      </tr>
      <tr>
        <td>max</td>
        <td>44.985000</td>
        <td>5.996600</td>
        <td>115.000000</td>
        <td>6.000000</td>
        <td>6.000000</td>
        <td>1.663232e+18</td>
      </tr>
    </tbody>
  </table>
</table-wrap>
</sec>
</sec>
<sec id="cell-8f6c52f4-b28d-4c22-88c7-e1b17298cae7-nb-1" specific-use="notebook-code">
<code language="python">df.plot.scatter(x=&quot;Longitude&quot;, y=&quot;Latitude&quot;, figsize=(12,12), grid=&quot;on&quot;);</code>
<sec id="8f6c52f4-b28d-4c22-88c7-e1b17298cae7-output-0-nb-1" specific-use="notebook-output">
<graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/cell-5-output-1.png" />
</sec>
</sec>
<sec id="af76febd-11cd-4927-8476-5d8258ede326-nb-1" specific-use="notebook-content">
<sec id="filter-down-to-la-palma-events-only-nb-1">
  <title>Filter down to La Palma events only</title>
  <p>Also some rows seem to be missing depth measurements, (see
  differences in the <bold>count</bold> for columns above) - take only
  rows with valid depths</p>
  </sec>
  <sec id="c34e47c1-c9cb-4207-978c-292333863e9b-nb-1" specific-use="notebook-code">
  <code language="python">df = df[(df['Latitude'] &lt; 28.7) &amp; (df['Latitude'] &gt; 28.3) &amp; (df['Longitude'] &lt; -17.7) &amp; (df['Longitude'] &gt; -18)]
df = df[df['Depth(km)'].notna()]
df.describe()</code>
  <sec id="c34e47c1-c9cb-4207-978c-292333863e9b-output-0-nb-1" specific-use="notebook-output">
  <table-wrap>
    <table border="1">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Latitude</th>
          <th>Longitude</th>
          <th>Depth(km)</th>
          <th>Magnitude</th>
          <th>Type Mag</th>
          <th>Timestamp</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>count</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
          <td>11347.000000</td>
          <td>11347.0</td>
          <td>1.134700e+04</td>
        </tr>
        <tr>
          <td>mean</td>
          <td>28.568893</td>
          <td>-17.844062</td>
          <td>14.089345</td>
          <td>2.432423</td>
          <td>4.0</td>
          <td>1.633359e+18</td>
        </tr>
        <tr>
          <td>std</td>
          <td>0.021899</td>
          <td>0.027345</td>
          <td>8.624787</td>
          <td>0.705282</td>
          <td>0.0</td>
          <td>2.007970e+16</td>
        </tr>
        <tr>
          <td>min</td>
          <td>28.310200</td>
          <td>-17.995800</td>
          <td>0.000000</td>
          <td>0.200000</td>
          <td>4.0</td>
          <td>1.489103e+18</td>
        </tr>
        <tr>
          <td>25%</td>
          <td>28.558000</td>
          <td>-17.854100</td>
          <td>10.100000</td>
          <td>1.900000</td>
          <td>4.0</td>
          <td>1.633777e+18</td>
        </tr>
        <tr>
          <td>50%</td>
          <td>28.564000</td>
          <td>-17.838700</td>
          <td>11.300000</td>
          <td>2.600000</td>
          <td>4.0</td>
          <td>1.635671e+18</td>
        </tr>
        <tr>
          <td>75%</td>
          <td>28.574300</td>
          <td>-17.829700</td>
          <td>13.900000</td>
          <td>2.900000</td>
          <td>4.0</td>
          <td>1.638294e+18</td>
        </tr>
        <tr>
          <td>max</td>
          <td>28.697800</td>
          <td>-17.705700</td>
          <td>46.900000</td>
          <td>5.100000</td>
          <td>4.0</td>
          <td>1.663128e+18</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  </sec>
  </sec>
  <sec id="cell-306ba432-daa7-4126-9b5a-689e1ad41e3a-nb-1" specific-use="notebook-code">
  <code language="python">plt.figure(figsize=(20,6))
plt.subplot(1,3,1)
df[&quot;Latitude&quot;].plot.hist(bins=20, density=True)
df[&quot;Latitude&quot;].plot.kde()
plt.subplot(1,3,2)
df[&quot;Longitude&quot;].plot.hist(bins=20, density=True)
df[&quot;Longitude&quot;].plot.kde()
plt.subplot(1,3,3)
df[&quot;Depth(km)&quot;].plot.hist(bins=50, density=True)
_=df[&quot;Depth(km)&quot;].plot.kde()</code>
  <sec id="306ba432-daa7-4126-9b5a-689e1ad41e3a-output-0-nb-1" specific-use="notebook-output">
  <graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/cell-7-output-1.png" />
  </sec>
  </sec>
  <sec id="cell-1bf2e599-12d6-40e9-bd99-db68ae6e72f5-nb-1" specific-use="notebook-content">
</sec>
<sec id="spatial-plot-nb-1">
  <title>Spatial Plot</title>
  <p>Scatter plot the spatial locations of events</p>
  </sec>
  <sec id="cell-fig-spatial-plot-nb-1" specific-use="notebook-code">
  <code language="python">from matplotlib import colormaps
cmap = colormaps['viridis_r']
ax = df.plot.scatter(x=&quot;Longitude&quot;, y=&quot;Latitude&quot;, 
                     s=40-df[&quot;Depth(km)&quot;], c=df[&quot;Magnitude&quot;], 
                     figsize=(12,10), grid=&quot;on&quot;, cmap=cmap)
colorbar = ax.collections[0].colorbar
colorbar.set_label(&quot;Magnitude&quot;)

plt.show()</code>
  <sec id="cell-fig-spatial-plot-output-0-nb-1" specific-use="notebook-output">
  <fig id="fig-spatial-plot-nb-1">
    <caption><p>Figure 1: Locations of earthquakes on La Palma since
    2017.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/fig-spatial-plot-output-1.png" />
  </fig>
  </sec>
  </sec>
  <sec id="c55cd6b8-7e01-4c2d-aa71-1649ca8aee01-nb-1" specific-use="notebook-content">
  <sec id="timeline-plot-nb-1">
    <title>Timeline Plot</title>
    <p>Scatter plot the event time series and look for any quantization
    issues. Have times &amp; dates been loaded correctly?</p>
    </sec>
    <sec id="cell-58a022c7-f34c-499d-a749-aa01f0e1b5db-nb-1" specific-use="notebook-code">
    <code language="python">ax = df.plot.scatter(x='DateTime', y='Depth(km)', figsize=(20,8))
ax.set_ylim(50,0);</code>
    <sec id="58a022c7-f34c-499d-a749-aa01f0e1b5db-output-0-nb-1" specific-use="notebook-output">
    <graphic mimetype="image" mime-subtype="png" xlink:href="data-screening_files/figure-jats/cell-9-output-1.png" />
    </sec>
    </sec>
    <sec id="f0a0d350-ed14-4128-9efe-cfcf2d05a66b-nb-1" specific-use="notebook-code">
    <code language="python">df['Swarm'] = 0
df.loc[(df['Date'] &gt;= '2017-10-01') &amp; (df['Date'] &lt;= '2017-10-31'), 'Swarm'] = 1
df.loc[(df['Date'] &gt;= '2019-02-01') &amp; (df['Date'] &lt;= '2019-02-28'), 'Swarm'] = 2
df.loc[(df['Date'] &gt;= '2020-07-21') &amp; (df['Date'] &lt;= '2020-08-05'), 'Swarm'] = 3
df.loc[(df['Date'] &gt;= '2020-10-04') &amp; (df['Date'] &lt;= '2020-10-10'), 'Swarm'] = 4
df.loc[(df['Date'] &gt;= '2020-10-11') &amp; (df['Date'] &lt;= '2020-10-22'), 'Swarm'] = 5
df.loc[(df['Date'] &gt;= '2020-11-15') &amp; (df['Date'] &lt;= '2020-11-29'), 'Swarm'] = 6
df.loc[(df['Date'] &gt;= '2020-12-10') &amp; (df['Date'] &lt;= '2020-12-29'), 'Swarm'] = 7
df.loc[(df['Date'] &gt;= '2020-12-10') &amp; (df['Date'] &lt;= '2020-12-31'), 'Swarm'] = 8
df.loc[(df['Date'] &gt;= '2021-01-15') &amp; (df['Date'] &lt;= '2021-02-07'), 'Swarm'] = 9
df.loc[(df['Date'] &gt;= '2021-06-01') &amp; (df['Date'] &lt;= '2021-06-30'), 'Swarm'] = 10
df.loc[(df['Date'] &gt;= '2021-07-01'), 'Swarm'] = None


df['Phase'] = 0;
df.loc[(df['Date'] &gt;= '2021-09-11') &amp; (df['Date'] &lt;= '2021-09-30'), 'Phase'] = 1
df.loc[(df['Date'] &gt;= '2021-10-01') &amp; (df['Date'] &lt;= '2021-11-30'), 'Phase'] = 2
df.loc[(df['Date'] &gt;= '2021-12-01') &amp; (df['Date'] &lt;= '2021-12-31'), 'Phase'] = 3
df.loc[(df['Date'] &gt;= '2021-12-31'), 'Phase'] = 4</code>
    </sec>
    <sec id="abd100da-cf39-47e4-8287-de4e9f5e3f6d-nb-1" specific-use="notebook-code">
    <code language="python">df.to_csv(&quot;../data/lapalma_ign.csv&quot;, index=False)</code>
    </sec>
  </sec>
</sec>
</body>



<back>
</back>


</sub-article>

</article>